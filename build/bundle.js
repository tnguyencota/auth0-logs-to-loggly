module.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=46)}([function(e,t){e.exports=require("auth0-extension-tools@1.2.1")},function(e,t,n){"use strict";e.exports=n(0).config()},function(e,t,n){const r=n(35),o=n(9),i=n(28),s=n(34);e.exports.createServer=r.createServer,e.exports.urlHelpers=o,e.exports.middlewares=i,e.exports.routes=s},function(e,t){e.exports=require("express@4.12.4")},function(e,t,n){"use strict";var r=n(79);r.emitErrs=!0;var o=new r.Logger({transports:[new r.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});e.exports=o,e.exports.stream={write:function(e){o.info(e.replace(/\n$/,""))}}},function(e,t){e.exports=require("util")},function(e,t,n){"use strict";var r,o=n(5),i=0===process.version.indexOf("v0.10.");r=i?function(){n.i({NODE_ENV:"production",CLIENT_VERSION:"2.0.2"}).NODE_DEBUG&&/agentkeepalive/.test(n.i({NODE_ENV:"production",CLIENT_VERSION:"2.0.2"}).NODE_DEBUG)&&console.log.apply(console.log,arguments)}:o.debuglog("agentkeepalive"),t.debug=r,t.isNode10=i,t.inherits=o.inherits},function(e,t){e.exports=require("lodash@3.10.1")},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);e=e||{},e.keepAlive=!1!==e.keepAlive,void 0===e.keepAliveTimeout&&(e.keepAliveTimeout=15e3),void 0===e.timeout&&(e.timeout=2*e.keepAliveTimeout),c.call(this,e);var t=this;t.createSocketCount=0,t.closeSocketCount=0,t.errorSocketCount=0,t.requestCount=0,t.timeoutSocketCount=0,t.on("free",function(){t.requestCount++}),t.on("timeout",function(){t.timeoutSocketCount++}),t.on("close",function(){t.closeSocketCount++}),t.on("error",function(){t.errorSocketCount++})}function o(e){var t={};for(var n in e)t[n]=e[n].length;return t}var i=n(17),s=n(6),c=n(23).Agent;i.Agent;e.exports=r,s.inherits(r,c),r.prototype.createSocket=function(e,t){var n=c.prototype.createSocket.call(this,e,t);return this.keepAlive&&n.setNoDelay(!0),this.createSocketCount++,n},r.prototype.getCurrentStatus=function(){return{createSocketCount:this.createSocketCount,closeSocketCount:this.closeSocketCount,errorSocketCount:this.errorSocketCount,timeoutSocketCount:this.timeoutSocketCount,requestCount:this.requestCount,freeSockets:o(this.freeSockets),sockets:o(this.sockets),requests:o(this.requests)}}},function(e,t,n){function r(e){if(!e.container)return null;const t=e.container.replace(a,"\\$&"),n=e.jtn?e.jtn.replace(a,"\\$&"):"";if(e.url_format===c)return new RegExp("^/api/run/"+t+"/(?:"+n+"/?)?");if(e.url_format===s)return new RegExp("^/"+t+"/(?:"+n+"/?)?");if(e.url_format===i)return new RegExp("^/(?:"+n+"/?)?");throw new Error("Unsupported webtask URL format.")}const o=n(20),i=3,s=2,c=1,a=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,u=function(e,t){var n=o.parse(e).pathname||"";return n=n.replace(t,"").replace(/^\/|\/$/g,""),n.startsWith("/")||(n="/"+n),n.endsWith("/")||(n+="/"),n};e.exports.getBasePath=function(e){return u(e.originalUrl||"",e.path)},e.exports.getBaseUrl=function(e,t){var n=t;const r=o.parse(e.originalUrl||"").pathname||"";return o.format({protocol:n||"https",host:e.headers.host,pathname:r.replace(e.path,"").replace(/\/$/g,"")})},e.exports.getWebtaskUrl=function(e){const t=r(e.x_wt),n=e.url,i=e.url.replace(t,"/"),s=o.parse(i||"").pathname,c=o.parse(n||"").pathname||"";var a=o.format({protocol:"https",host:e.headers.host,pathname:c.replace(s,"").replace(/\/$/g,"")});return e.x_wt&&(0===a.indexOf("https://sandbox.it.auth0.com")?a=a.replace("https://sandbox.it.auth0.com/api/run/"+e.x_wt.container+"/","https://"+e.x_wt.container+".us.webtask.io/"):0===a.indexOf("https://sandbox-eu.it.auth0.com")?a=a.replace("https://sandbox-eu.it.auth0.com/api/run/"+e.x_wt.container+"/","https://"+e.x_wt.container+".eu.webtask.io/"):0===a.indexOf("https://sandbox-au.it.auth0.com")&&(a=a.replace("https://sandbox-au.it.auth0.com/api/run/"+e.x_wt.container+"/","https://"+e.x_wt.container+".au.webtask.io/"))),a}},function(e,t,n){function r(e){if(null===e||void 0===e)throw new c.ArgumentError("Must provide an options object");if(null===e.domain||void 0===e.domain)throw new c.ArgumentError("Must provide a valid domain");if("string"!=typeof e.domain||0===e.domain.length)throw new c.ArgumentError("The provided domain is invalid: "+e.domain);if(null===e.clientId||void 0===e.clientId)throw new c.ArgumentError("Must provide a valid clientId");if("string"!=typeof e.clientId||0===e.clientId.length)throw new c.ArgumentError("The provided clientId is invalid: "+e.clientId);if(null===e.clientSecret||void 0===e.clientSecret)throw new c.ArgumentError("Must provide a valid clientSecret");if("string"!=typeof e.clientSecret||0===e.clientSecret.length)throw new c.ArgumentError("The provided clientSecret is invalid: "+e.clientSecret);this.options=e,this.tokenCache=e.tokenCache||{getToken:function(){return o.resolve()},setToken:function(){return o.resolve()}}}const o=n(15),i=n(19),s=n(75),c=n(0);r.prototype.getAccessToken=function(){var e=this;return new o(function(t,n){i.post("https://"+e.options.domain+"/oauth/token").send({audience:"https://"+e.options.domain+"/api/v2/",client_id:e.options.clientId,client_secret:e.options.clientSecret,grant_type:"client_credentials"}).set("Accept","application/json").end(function(r,o){if(r&&401===r.status)return n(new c.ManagementApiError("unauthorized","Invalid credentials for "+e.options.clientId,r.status));if(r&&o&&o.body&&o.body.error)return n(new c.ManagementApiError(o.body.error,o.body.error_description||o.body.error,r.status));if(r)return n(r);if(!o.ok||!o.body.access_token)return n(new c.ManagementApiError("unknown_error","Unknown error from Management API or no access_token was provided: "+(o.text||o.status)));const i=new Date;return t({token:o.body.access_token,expiresAt:i.setSeconds(i.getSeconds()+o.body.expires_in)})})})},r.prototype.getAccessTokenCached=function(){var e=this;return e.tokenCache.getToken().then(function(t){if(t&&t.token){const n=(new Date).valueOf();if(t.expiresAt-n>1e4)return t}return e.getAccessToken(e.options).then(function(t){return e.tokenCache.setToken(t).then(function(){return t})})})},r.prototype.getLogs=function(e){const t=this;return new o(function(n,r){t.getAccessTokenCached(t.options,t.storage).then(function(o){const a=s.stringify(e);i.get("https://"+t.options.domain+"/api/v2/logs?"+a).set("Authorization","Bearer "+o.token).set("Content-Type","application/json").end(function(e,o){if(e&&403===e.status){const i=function(){return r(new c.ManagementApiError(o.body.error,o.body.error_description||o.body.error,e.status))};t.tokenCache.setToken(null).then(i).catch(i)}return e&&o&&o.body&&o.body.error?r(new c.ManagementApiError(o.body.error,o.body.error_description||o.body.error,e.status)):e?r(e):o.ok?n({logs:o.body,limits:{limit:o.headers["x-ratelimit-limit"],remaining:o.headers["x-ratelimit-remaining"],reset:o.headers["x-ratelimit-reset"]}}):r(new c.ManagementApiError("unknown_error","Unknown error from Management API: "+(o.text||o.status)))})})})},e.exports=r},function(e,t){const n={s:{name:"Success Login",icon:"icon-budicon-448",level:1},ssa:{name:"Success Silent Auth",icon:"icon-budicon-448",level:1},fsa:{name:"Failed Silent Auth",icon:"icon-budicon-448",level:3},seacft:{name:"Success Exchange",description:"Authorization Code for Access Token",icon:"icon-budicon-456",level:1},feacft:{name:"Failed Exchange",description:"Authorization Code for Access Token",icon:"icon-budicon-456",level:3},seccft:{name:"Success Exchange",description:"Client Credentials for Access Token",icon:"icon-budicon-456",level:1},feccft:{name:"Failed Exchange",description:"Client Credentials for Access Token",icon:"icon-budicon-456",level:3},sepft:{name:"Success Exchange",description:"Password for Access Token",icon:"icon-budicon-456",level:1},fepft:{name:"Failed Exchange",description:"Password for Access Token",icon:"icon-budicon-456",level:3},sertft:{name:"Success Exchange",description:"Refresh Token for Access Token",icon:"icon-budicon-456",level:1},fertft:{name:"Failed Exchange",description:"Refresh Token for Access Token",icon:"icon-budicon-456",level:3},seoobft:{name:"Success Exchange",description:"Password and OOB Challenge for Access Token",icon:"icon-budicon-456",level:1},feoobft:{name:"Failed Exchange",description:"Password and OOB Challenge for Access Token",icon:"icon-budicon-456",level:3},seotpft:{name:"Success Exchange",description:"Password and OTP Challenge for Access Token",icon:"icon-budicon-456",level:1},feotpft:{name:"Failed Exchange",description:"Password and OTP Challenge for Access Token",icon:"icon-budicon-456",level:3},sercft:{name:"Success Exchange",description:"Password and MFA Recovery code for Access Token",icon:"icon-budicon-456",level:1},fercft:{name:"Failed Exchange",description:"Password and MFA Recovery code for Access Token",icon:"icon-budicon-456",level:3},f:{name:"Failed Login",icon:"icon-budicon-448",level:3},w:{name:"Warning",icon:"icon-budicon-354",level:2},du:{name:"Deleted User",icon:"icon-budicon-311",level:3},fu:{name:"Failed Login (invalid email/username)",icon:"icon-budicon-311",level:3},fp:{name:"Failed Login (wrong password)",icon:"icon-budicon-311",level:3},fc:{name:"Failed by Connector",icon:"icon-budicon-313",level:3},fco:{name:"Failed by CORS",icon:"icon-budicon-313",level:3},con:{name:"Connector Online",icon:"icon-budicon-143",level:1},coff:{name:"Connector Offline",icon:"icon-budicon-143",level:3},fcpro:{name:"Failed Connector Provisioning",icon:"icon-budicon-143",level:4},ss:{name:"Success Signup",icon:"icon-budicon-314",level:1},fs:{name:"Failed Signup",icon:"icon-budicon-311",level:3},cs:{name:"Code Sent",icon:"icon-budicon-243",level:1},cls:{name:"Code/Link Sent",icon:"icon-budicon-781",level:1},sv:{name:"Success Verification Email",icon:"icon-budicon-781",level:1},fv:{name:"Failed Verification Email",icon:"icon-budicon-311",level:3},scp:{name:"Success Change Password",icon:"icon-budicon-280",level:1},fcp:{name:"Failed Change Password",icon:"icon-budicon-266",level:3},sce:{name:"Success Change Email",icon:"icon-budicon-266",level:1},fce:{name:"Failed Change Email",icon:"icon-budicon-266",level:3},scu:{name:"Success Change Username",icon:"icon-budicon-266",level:1},fcu:{name:"Failed Change Username",icon:"icon-budicon-266",level:3},scpn:{name:"Success Change Phone Number",icon:"icon-budicon-266",level:1},fcpn:{name:"Failed Change Phone Number",icon:"icon-budicon-266",level:3},svr:{name:"Success Verification Email Request",icon:"icon-budicon-781",level:0},fvr:{name:"Failed Verification Email Request",icon:"icon-budicon-311",level:3},scpr:{name:"Success Change Password Request",icon:"icon-budicon-280",level:1},fcpr:{name:"Failed Change Password Request",icon:"icon-budicon-311",level:3},fn:{name:"Failed Sending Notification",icon:"icon-budicon-782",level:3},sapi:{name:"API Operation",icon:"icon-budicon-546",level:1},fapi:{name:"Failed API Operation",icon:"icon-budicon-546",level:3},limit_wc:{name:"Blocked Account",icon:"icon-budicon-313",level:4},limit_mu:{name:"Blocked IP Address",icon:"icon-budicon-313",level:4},limit_ui:{name:"Too Many Calls to /userinfo",icon:"icon-budicon-313",level:4},api_limit:{name:"Rate Limit On API",icon:"icon-budicon-313",level:4},limit_delegation:{name:"Too Many Calls to /delegation",icon:"icon-budicon-313",level:4},sdu:{name:"Successful User Deletion",icon:"icon-budicon-312",level:1},fdu:{name:"Failed User Deletion",icon:"icon-budicon-311",level:3},slo:{name:"Success Logout",icon:"icon-budicon-449",level:1},flo:{name:"Failed Logout",icon:"icon-budicon-449",level:3},sd:{name:"Success Delegation",icon:"icon-budicon-456",level:1},fd:{name:"Failed Delegation",icon:"icon-budicon-456",level:3},gd_unenroll:{name:"Unenroll device account",icon:"icon-budicon-298",level:1},gd_update_device_account:{name:"Update device account",icon:"icon-budicon-257",level:1},gd_module_switch:{name:"Module switch",icon:"icon-budicon-329",level:1},gd_tenant_update:{name:"Guardian tenant update",icon:"icon-budicon-170",level:1},gd_start_auth:{name:"Second factor started",icon:"icon-budicon-285",level:1},gd_start_enroll:{name:"Enroll started",icon:"icon-budicon-299",level:1},gd_user_delete:{name:"User delete",icon:"icon-budicon-298",level:1},gd_auth_succeed:{name:"OTP Auth suceed",icon:"icon-budicon-mfa-login-succeed",level:1},gd_auth_failed:{name:"OTP Auth failed",icon:"icon-budicon-mfa-login-failed",level:3},gd_send_pn:{name:"Push notification sent",icon:"icon-budicon-mfa-send-pn",level:1},gd_auth_rejected:{name:"OTP Auth rejected",icon:"icon-budicon-mfa-login-failed",level:3},gd_recovery_succeed:{name:"Recovery succeed",icon:"icon-budicon-mfa-recovery-succeed",level:1},gd_recovery_failed:{name:"Recovery failed",icon:"icon-budicon-mfa-recovery-failed",level:3},gd_send_sms:{name:"SMS Sent",icon:"icon-budicon-799",level:1},gd_otp_rate_limit_exceed:{name:"Too many failures",icon:"icon-budicon-435",level:2},gd_recovery_rate_limit_exceed:{name:"Too many failures",icon:"icon-budicon-435",level:2},fui:{name:"Users import",icon:"icon-budicon-299",level:2},sui:{name:"Users import",icon:"icon-budicon-299",level:1},pwd_leak:{name:"Breached password",icon:"icon-budicon-313",level:3}};e.exports=n,e.exports.get=function(e){return n[e]&&n[e].name||"Unknown Log Type: "+e}},function(e,t,n){function r(e){if(null===e||void 0===e)throw new s.ArgumentError("Must provide an options object");i.call(this,{objectMode:!0}),this.client=new c(e),this.options=e,this.remaining=50,this.lastBatch=0,this.previousCheckpoint=e.checkpointId||null,this.lastCheckpoint=e.checkpointId||null,this.status={start:new Date,end:null,logsProcessed:0}}const o=n(5),i=n(77).Readable,s=n(0),c=n(10);o.inherits(r,i),r.prototype.getQuery=function(e){return e&&e.length?"type:"+e.join(" OR type:"):""},r.prototype.done=function(){this.status.end=new Date,this.push(null)},r.prototype.next=function(e){const t=this;if(t.remaining<1)t.status.warning="Auth0 Management API rate limit reached.",t.done();else{const n=t.lastCheckpoint?{take:100,from:t.lastCheckpoint}:{per_page:100,page:0};n.q=t.getQuery(t.options.types),n.sort="date:1",t.client.getLogs(n).then(function(n){const r=n.logs;if(t.remaining=n.limits.remaining,r&&r.length){const o=t.options.types&&t.options.types.length?r.filter(function(e){return t.options.types.indexOf(e.type)>=0}).slice(0,e||100):r;o.length?(t.lastCheckpoint=o[o.length-1]._id,t.lastBatch+=o.length,t.push({logs:o,limits:n.limits})):(t.lastCheckpoint=r[r.length-1]._id,t.lastBatch+=0,t.push({logs:[],limits:n.limits}))}else t.status.end=new Date,t.push(null);return r}).catch(function(e){t.emit("error",e)})}},r.prototype.batchSaved=function(){this.status.logsProcessed+=this.lastBatch,this.previousCheckpoint=this.lastCheckpoint,this.lastBatch=0},r.prototype._read=function(){},e.exports=r},function(e,t,n){"use strict";var r=n(61);e.exports=function(e,t,n){return function(o,i,s){for(var c=arguments.length,a=Array(c>3?c-3:0),u=3;u<c;u++)a[u-3]=arguments[u];var l=r(s);return!0===e||"function"==typeof e&&e.apply(void 0,[o,i,l].concat(a))?t.apply(void 0,[o,i,l].concat(a)):n?n.apply(void 0,[o,i,l].concat(a)):l()}}},function(e,t,n){"use strict";function r(e){this.message=e}var o=n(52);r.prototype=new Error,r.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");t=t||{};var n=!0===t.header?0:1;try{return JSON.parse(o(e.split(".")[n]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t){e.exports=require("bluebird@3.4.6")},function(e,t){e.exports=require("express-jwt@3.1.0")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("superagent@1.2.0")},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";(function(t){var r=(n(20),n(18)),o=n(72),i=n(3),s=n(63),c=n(0),a=n(2),u=n(44),l=n(45),f=n(42),p=n(4),d=n(1),h=n(41);e.exports=function(e,n){d.setProvider(e);var g=n?new c.WebtaskStorageContext(n,{force:1}):new c.FileStorageContext(r.join(t,"./data.json"),{mergeWrites:!0}),v=new i;v.use(o(":method :url :status :response-time ms - :res[content-length]",{stream:p.stream}));var m=function(e){return function(t,n,r){return t.webtaskContext&&t.webtaskContext.body?(t.body=t.webtaskContext.body,r()):e(t,n,r)}};return v.use(m(s.json())),v.use(m(s.urlencoded({extended:!1}))),v.use("/meta",l()),v.use("/.extensions",f()),v.use(h(g)),v.use(a.routes.dashboardAdmins({secret:d("EXTENSION_SECRET"),audience:"urn:logs-to-logdna",rta:d("AUTH0_RTA").replace("https://",""),domain:d("AUTH0_DOMAIN"),baseUrl:d("PUBLIC_WT_URL")||d("WT_URL"),clientName:"Logs to logdna",urlPrefix:"",sessionStorageKey:"logs-to-logdna:apiToken"})),v.use("/app",i.static(r.join(t,"../dist"))),v.use("/",u(g)),v.use(a.middlewares.errorHandler(p.error.bind(p))),v}}).call(t,"/")},function(e,t,n){e.exports=n(8),e.exports.HttpsAgent=n(24)},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);c.call(this);var t=this;t.defaultPort=80,t.protocol="http:",t.options=s._extend({},e),t.options.path=null,t.requests={},t.sockets={},t.freeSockets={},t.keepAliveMsecs=t.options.keepAliveMsecs||1e3,t.keepAlive=t.options.keepAlive||!1,t.keepAliveTimeout=t.options.keepAliveTimeout||0,t.timeout=t.options.timeout||0,t.maxSockets=t.options.maxSockets||r.defaultMaxSockets,t.maxFreeSockets=t.options.maxFreeSockets||256,t.on("free",function(e,n){var r=t.getName(n);if(a("agent.on(free)",r),!e.destroyed&&t.requests[r]&&t.requests[r].length)t.requests[r].shift().onSocket(e),0===t.requests[r].length&&delete t.requests[r],a("continue handle next request");else{var i=e._httpMessage;if(i&&i.shouldKeepAlive&&!e.destroyed&&t.options.keepAlive){var s=t.freeSockets[r],c=s?s.length:0,u=c;t.sockets[r]&&(u+=t.sockets[r].length),u>t.maxSockets||c>=t.maxFreeSockets?(t.removeSocket(e,n),e.destroy()):(s=s||[],t.freeSockets[r]=s,e.setKeepAlive(!0,t.keepAliveMsecs),e.unref&&e.unref(),e._httpMessage=null,t.removeSocket(e,n),s.push(e),0===e.listeners("error").length&&e.once("error",o),e.setTimeout(t.keepAliveTimeout))}else t.removeSocket(e,n),e.destroy()}})}function o(e){var t=this;a("SOCKET ERROR on FREE socket:",e.message,e.stack),t.destroy(),t.emit("agentRemove")}var i=n(73),s=n(5),c=n(68).EventEmitter,a=n(6).debug;s.inherits(r,c),t.Agent=r,r.defaultMaxSockets=1/0,r.prototype.createConnection=i.createConnection,r.prototype.getName=function(e){var t="";return e.host?t+=e.host:t+="localhost",t+=":",e.port&&(t+=e.port),t+=":",e.localAddress&&(t+=e.localAddress),t+=":"},r.prototype.addRequest=function(e,t){"string"==typeof t&&(t={host:t,port:arguments[2],path:arguments[3]}),t=s._extend({},t),t=s._extend(t,this.options);var n=this.getName(t);this.sockets[n]||(this.sockets[n]=[]);var r=this.freeSockets[n]?this.freeSockets[n].length:0,i=r+this.sockets[n].length;if(r){var c=this.freeSockets[n].shift();a("have free socket"),c.removeListener("error",o),c.setTimeout(this.timeout),this.freeSockets[n].length||delete this.freeSockets[n],c.ref&&c.ref(),e.onSocket(c),this.sockets[n].push(c)}else i<this.maxSockets?(a("call onSocket",i,r),e.onSocket(this.createSocket(e,t))):(a("wait for socket"),this.requests[n]||(this.requests[n]=[]),this.requests[n].push(e))},r.prototype.createSocket=function(e,t){function n(){c.emit("free",f,t)}function r(e){a("CLIENT socket onClose"),"boolean"!=typeof f.destroyed&&(f.destroyed=!0),c.removeSocket(f,t),c.emit("close")}function o(){a("CLIENT socket onTimeout"),f.destroy(),c.removeSocket(f,t),c.emit("timeout")}function i(){a("CLIENT socket onRemove"),c.removeSocket(f,t),f.removeListener("close",r),f.removeListener("free",n),f.removeListener("agentRemove",i),f.setTimeout(0,o)}var c=this;if(t=s._extend({},t),t=s._extend(t,c.options),!t.servername&&(t.servername=t.host,e)){var u=e.getHeader("host");u&&(t.servername=u.replace(/:.*$/,""))}var l=c.getName(t);a("createConnection",l,t),t.encoding=null;var f=c.createConnection(t);return c.sockets[l]||(c.sockets[l]=[]),this.sockets[l].push(f),a("sockets",l,this.sockets[l].length),f.on("free",n),f.on("close",r),f.on("timeout",o),f.setTimeout(c.timeout),f.on("agentRemove",i),f},r.prototype.removeSocket=function(e,t){var n,r,o=this.getName(t);a("removeSocket",o,"destroyed:",e.destroyed);var i=[this.sockets];e.destroyed&&i.push(this.freeSockets);for(var s=0;s<i.length;s++){var c=i[s];if(c[o]){var u=c[o].indexOf(e);-1!==u&&(c[o].splice(u,1),0===c[o].length&&delete c[o])}}if(n=this.freeSockets[o]?this.freeSockets[o].length:0,r=n+this.sockets[o]?this.sockets[o].length:0,this.requests[o]&&this.requests[o].length&&r<this.maxSockets){a("removeSocket, have a request, make a socket");var l=this.requests[o][0];this.createSocket(l,t).emit("free")}},r.prototype.destroy=function(){for(var e=[this.freeSockets,this.sockets],t=0;t<e.length;t++)for(var n=e[t],r=Object.keys(n),o=0;o<r.length;o++)for(var i=n[r[o]],s=0;s<i.length;s++)i[s].destroy()},t.globalAgent=new r},function(e,t,n){"use strict";var r,o=n(17),i=n(6),s=n(8),c=o.Agent;i.isNode10?(r=function(e){s.call(this,e),this.defaultPort=443,this.protocol="https:"},i.inherits(r,s),r.prototype.createConnection=o.globalAgent.createConnection,r.prototype.getName=function(e){var t=s.prototype.getName.call(this,e);return t+=":",e.ca&&(t+=e.ca),t+=":",e.cert&&(t+=e.cert),t+=":",e.ciphers&&(t+=e.ciphers),t+=":",e.key&&(t+=e.key),t+=":",e.pfx&&(t+=e.pfx),t+=":",void 0!==e.rejectUnauthorized&&(t+=e.rejectUnauthorized),t}):(r=function(e){s.call(this,e),this.defaultPort=443,this.protocol="https:",this.maxCachedSessions=this.options.maxCachedSessions,void 0===this.maxCachedSessions&&(this.maxCachedSessions=100),this._sessionCache={map:{},list:[]}},i.inherits(r,s),["createConnection","getName","_getSession","_cacheSession","_evictSession"].forEach(function(e){"function"==typeof c.prototype[e]&&(r.prototype[e]=c.prototype[e])})),e.exports=r},function(e,t,n){const r=n(14),o=n(16),i=n(0),s=n(13);e.exports=function(e){if(!e||"object"!=typeof e)throw new i.ArgumentError("Must provide the options");if(null===e.secret||void 0===e.secret)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof e.secret||0===e.secret.length)throw new i.ArgumentError("The provided secret is invalid: "+e.secret);if(null===e.audience||void 0===e.audience)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof e.audience||0===e.audience.length)throw new i.ArgumentError("The provided audience is invalid: "+e.audience);if(null===e.baseUrl||void 0===e.baseUrl)throw new i.ArgumentError("Must provide a valid base URL");if("string"!=typeof e.baseUrl||0===e.baseUrl.length)throw new i.ArgumentError("The provided base URL is invalid: "+e.baseUrl);const t=o({audience:e.audience,issuer:e.baseUrl,secret:e.secret,algorithms:["HS256"],credentialsRequired:e.credentialsRequired||!0});return function(n,r,o){t(n,r,function(t){return t?o(t):e.onLoginSuccess?e.onLoginSuccess(n,r,o):o()})}},e.exports.optional=function(t){const n=e.exports(t);return s(function(e){if(e&&e.headers&&e.headers.authorization&&0===e.headers.authorization.indexOf("Bearer "))try{const n=r(e.headers.authorization.split(" ")[1]);return n&&n.iss===t.baseUrl}catch(e){return!1}return!1},n)}},function(e,t,n){const r=n(14),o=n(16),i=n(70),s=n(0),c=n(13),a=n(0).UnauthorizedError;e.exports=function(e){if(!e||"object"!=typeof e)throw new s.ArgumentError("Must provide the options");if(null===e.domain||void 0===e.domain)throw new s.ArgumentError("Must provide a valid domain");if("string"!=typeof e.domain||0===e.domain.length)throw new s.ArgumentError("The provided domain is invalid: "+e.domain);if(null===e.audience||void 0===e.audience)throw new s.ArgumentError("Must provide a valid audience");if("string"!=typeof e.audience||0===e.audience.length)throw new s.ArgumentError("The provided audience is invalid: "+e.audience);const t=o({secret:i.expressJwtSecret({cache:!0,rateLimit:!0,jwksRequestsPerMinute:5,jwksUri:"https://"+e.domain+"/.well-known/jwks.json",handleSigningKeyError:function(e,t){return t(e instanceof i.SigningKeyNotFoundError?new a("A token was provided with an invalid kid"):e)}}),audience:e.audience,issuer:"https://"+e.domain+"/",algorithms:["RS256"],credentialsRequired:e&&e.credentialsRequired||!0});return function(n,r,o){t(n,r,function(t){return t?o(t):e.onLoginSuccess?e.onLoginSuccess(n,r,o):o()})}},e.exports.optional=function(t){const n=e.exports(t);return c(function(e){if(e&&e.headers&&e.headers.authorization&&0===e.headers.authorization.indexOf("Bearer "))try{const n=r(e.headers.authorization.split(" ")[1]);return n&&n.iss==="https://"+t.domain+"/"}catch(e){return!1}return!1},n)}},function(e,t,n){e.exports=function(e){return function(t,n,r,o){return e&&e(t),t&&t.status?(r.status(t.status),r.json({error:t.code||t.name,message:t.message||t.name})):(r.status(t.status||500),r.json({error:"InternalServerError",message:t.message||t.name}))}}},function(e,t,n){e.exports.authenticateAdmins=n(25),e.exports.authenticateUsers=n(26),e.exports.requireAuthentication=n(30),e.exports.errorHandler=n(27),e.exports.managementApiClient=n(29),e.exports.validateHookToken=n(31),e.exports.webtaskConfig=n(32)},function(e,t,n){const r=n(0);e.exports=function(e){return function(t,n,o){const i=t,s=t.user&&t.user.access_token&&t.user.access_token.length,c=s?{domain:e.domain,accessToken:t.user.access_token}:e;r.managementApi.getClient(c).then(function(e){return i.auth0=e,o(),null}).catch(function(e){o(e)})}}},function(e,t,n){const r=n(0).UnauthorizedError;e.exports=function(e,t,n){return e.user?n():n(new r("Authentication required for this endpoint."))}},function(e,t,n){const r=n(0);e.exports=function(e,t,n){if(null===e||void 0===e)throw new r.ArgumentError("Must provide the domain");if("string"!=typeof e||0===e.length)throw new r.ArgumentError("The provided domain is invalid: "+e);if(null===t||void 0===t)throw new r.ArgumentError("Must provide the webtaskUrl");if("string"!=typeof t||0===t.length)throw new r.ArgumentError("The provided webtaskUrl is invalid: "+t);if(null===n||void 0===n)throw new r.ArgumentError("Must provide the extensionSecret");if("string"!=typeof n||0===n.length)throw new r.ArgumentError("The provided extensionSecret is invalid: "+n);return function(o){if(null===o||void 0===o)throw new r.ArgumentError("Must provide the hookPath");if("string"!=typeof o||0===o.length)throw new r.ArgumentError("The provided hookPath is invalid: "+o);return function(i,s,c){if(i.headers.authorization&&"Bearer"===i.headers.authorization.split(" ")[0]){const a=i.headers.authorization.split(" ")[1];try{if(r.validateHookToken(e,t,o,n,a))return c()}catch(e){return c(e)}}return c(new r.HookTokenError("Hook token missing for the call to: "+o))}}}},function(e,t,n){const r=n(0);e.exports=function(e){return function(t,n,o){return t.webtaskContext&&e.setProvider(r.configProvider.fromWebtaskContext(t.webtaskContext)),o()}}},function(e,t,n){const r=n(3),o=n(66),i=n(47),s=n(0),c=n(9);e.exports=function(e){if(!e||"object"!=typeof e)throw new s.ArgumentError("Must provide the options");if(null===e.secret||void 0===e.secret)throw new s.ArgumentError("Must provide a valid secret");if("string"!=typeof e.secret||0===e.secret.length)throw new s.ArgumentError("The provided secret is invalid: "+e.secret);if(null===e.audience||void 0===e.audience)throw new s.ArgumentError("Must provide a valid secret");if("string"!=typeof e.audience||0===e.audience.length)throw new s.ArgumentError("The provided audience is invalid: "+e.audience);if(null===e.rta||void 0===e.rta)throw new s.ArgumentError("Must provide a valid rta");if("string"!=typeof e.rta||0===e.rta.length)throw new s.ArgumentError("The provided rta is invalid: "+e.rta);if(null===e.domain||void 0===e.domain)throw new s.ArgumentError("Must provide a valid domain");if("string"!=typeof e.domain||0===e.domain.length)throw new s.ArgumentError("The provided domain is invalid: "+e.domain);if(null===e.baseUrl||void 0===e.baseUrl)throw new s.ArgumentError("Must provide a valid base URL");if("string"!=typeof e.baseUrl||0===e.baseUrl.length)throw new s.ArgumentError("The provided base URL is invalid: "+e.baseUrl);if(null===e.clientName||void 0===e.clientName)throw new s.ArgumentError("Must provide a valid client name");if("string"!=typeof e.clientName||0===e.clientName.length)throw new s.ArgumentError("The provided client name is invalid: "+e.clientName);const t=e.stateKey||"state",n=e.urlPrefix||"",a=e.sessionStorageKey||"apiToken",u=r.Router();return u.get(n+"/login",function(r,i){const a=o.randomBytes(16).toString("hex");i.cookie(t,a);const u=new s.SessionManager(e.rta,e.domain,e.baseUrl),l=u.createAuthorizeUrl({redirectUri:c.getBaseUrl(r)+n+"/login/callback",scopes:e.scopes,expiration:e.expiration});i.redirect(l+"&state="+a)}),u.post(n+"/login/callback",i(),function(n,r,o){return n.cookies&&n.cookies[t]===n.body.state?new s.SessionManager(e.rta,e.domain,e.baseUrl).create(n.body.id_token,n.body.access_token,{secret:e.secret,issuer:e.baseUrl,audience:e.audience}).then(function(e){r.header("Content-Type","text/html"),r.status(200).send('<html><head><script type="text/javascript">sessionStorage.setItem("'+a+'", "'+e+'");window.location.href = "'+c.getBaseUrl(n)+'";<\/script></head></html>')}).catch(function(e){o(e)}):o(new s.ValidationError("Login failed. State mismatch."))}),u.get(n+"/logout",function(t,n){const r=encodeURIComponent(c.getBaseUrl(t));n.header("Content-Type","text/html"),n.status(200).send('<html><head><script type="text/javascript">sessionStorage.removeItem("'+a+'");window.location.href = "https://'+e.rta+"/v2/logout/?returnTo="+r+"&client_id="+r+'";<\/script></head></html>')}),u.get("/.well-known/oauth2-client-configuration",function(t,r){r.header("Content-Type","application/json"),r.status(200).send({redirect_uris:[c.getBaseUrl(t)+n+"/login/callback"],client_name:e.clientName,post_logout_redirect_uris:[c.getBaseUrl(t)]})}),u}},function(e,t,n){e.exports.dashboardAdmins=n(33)},function(e,t,n){const r=n(0),o=n(78);e.exports.createServer=function(e){const t=r.createServer(e);var n=null;return o.fromExpress(function(e,r){return n||(n=t(e.webtaskContext)),n(e,r)})}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){const r=n(39);e.exports.LogsProcessor=n(38),e.exports.LogsApiClient=n(10),e.exports.LogsApiStream=n(12),e.exports.logTypes=n(11),e.exports.reporters={SlackReporter:r}},function(e,t,n){function r(e,t){if(null===t||void 0===t)throw new i.ArgumentError("Must provide an options object");this.storage=new a(e),this.options=o.assign({},{batchSize:100,maxRetries:5,maxRunTimeSeconds:20},t)}const o=n(7),i=n(0),s=n(11),c=n(12),a=n(40);r.prototype.hasTimeLeft=function(e){const t=(new Date).getTime();return e+1e3*this.options.maxRunTimeSeconds>=t},r.prototype.getLogFilter=function(e){var t=e.logTypes||[];if(e.logLevel){const n=o.map(s,function(e,t){const n=e;return n.type=t,n});t=t.concat(o.map(o.filter(n,function(t){return t.level>=e.logLevel}),"type"))}return o.uniq(t)},r.prototype.getReport=function(e,t){const n=new Date(e).getTime(),r=t?new Date(t).getTime():(new Date).getTime();return this.storage.read().then(function(e){return o.filter(e.logs,function(e){const t=new Date(e.start).getTime(),o=new Date(e.end).getTime();return t>=n&&o<=r})}).then(function(e){const t={type:"report",processed:0,warnings:0,errors:0,checkpoint:""};return o.each(e,function(e){t.processed+=e.logsProcessed,t.checkpoint=e.checkpoint,e.error&&(t.errors+=1),e.warning&&(t.warnings+=1)}),t})},r.prototype.createStream=function(e){const t=this;return t.storage.getCheckpoint(e.startFrom).then(function(n){return t.options.logger&&t.options.logger.debug("Starting logs processor from checkpoint:",n),new c({checkpointId:n,types:t.getLogFilter(e),domain:e.domain,clientId:e.clientId,clientSecret:e.clientSecret,tokenCache:t.storage})})},r.prototype.run=function(e){const t=this;return new Promise(function(n,r){const o=(new Date).getTime();var i=0,s=0,c=[];const a=t.storage,u=(t.options,t.options.batchSize),l=t.options.maxRetries,f=function(e,o,i){t.options.logger&&t.options.logger.debug("Processor failed:",e),o.error=e,a.done(o,i).then(function(){return n({status:o,checkpoint:i})}).catch(r)},p=function(e,o){if(t.options.logger&&t.options.logger.debug("Processor run complete. Logs processed:",e.logsProcessed),e.logsProcessed>0){return(new Date).getTime()-s>=6048e5&&(e.warning="Logs are outdated more than for week. Last processed log has date is "+new Date(s)),a.done(e,o).then(function(){return n({status:e,checkpoint:o})}).catch(r)}return n({status:e,checkpoint:o})},d=function(){var e=u;return e-=c.length,e>100&&(e=100),e},h=function(n,r,s){if(!t.hasTimeLeft(o))return f(n,r.status,r.previousCheckpoint);if(i<l)return i+=1,e(c,s);const a=[n,"Skipping logs from "+r.previousCheckpoint+" to "+r.lastCheckpoint+" after "+l+" retries."];return t.options.logger&&t.options.logger.error(a[0],a[1]),f(a,r.status,r.lastCheckpoint)};t.createStream(t.options).then(function(n){const r=d();t.options.logger&&t.options.logger.debug("Loading next batch of logs. Next limit:",r),n.next(r),n.on("data",function(r){const i=r.logs;if(c=c.concat(i),i&&i.length&&(s=new Date(i[i.length-1].date).getTime()),c.length<u&&t.hasTimeLeft(o))return n.next(d());const a=function(e){return e?h(e,n,a):(c=[],t.hasTimeLeft(o)?(n.batchSaved(),n.next(d())):n.done())};return e(c,a)}),n.on("end",function(){const t=function(e){return e?h(e,n,t):(n.batchSaved(),p(n.status,n.lastCheckpoint))};e(c,t)}),n.on("error",function(e){f(e,n.status,n.previousCheckpoint)})}).catch(r)})},e.exports=r},function(e,t,n){function r(e){this.options=e||{}}const o=n(15),i=n(19);r.prototype.send=function(e,t){if(!e||"object"!=typeof e)throw new Error("object status is required");const n=this.options,r=this.createMessage(this.options,e,t);return new o(function(e,t){return n.hook?i.post(n.hook).send(r).set("Accept","application/json").end(function(n){return n?t(n):e()}):e()})},r.prototype.createMessage=function(e,t,n){const r={username:e.username||"auth0-logger",icon_emoji:e.icon||":rocket:",attachments:[]},o=e.title||"Auth0 Logger",i="report"===t.type?o+" Daily Report":t.error?o+" Error":o+" Success",s=t.error||null,c={fallback:e.fallback||i,text:e.text||i,error_field:{title:"Error",value:JSON.stringify(s),short:!1}};"report"===t.type?c.fields=[{title:"Logs processed",value:t.processed,short:!0},{title:"Warnings",value:t.warnings,short:!0},{title:"Errors",value:t.errors,short:!0},{title:"Next checkpoint",value:t.checkpoint,short:!0}]:c.fields=[{title:"Start time",value:t.start,short:!0},{title:"End time",value:t.end,short:!0},{title:"Logs processed",value:t.logsProcessed,short:!0},{title:"Next checkpoint",value:n,short:!0}];const a=e.url?" (<"+e.url+"|Details>)":null,u=c.fields;return t.error&&u.push(c.error_field),r.attachments.push({color:t.error?"#d13f42":"#7cd197",fallback:c.fallback,text:c.fallback+(a||""),fields:u}),r},e.exports=r},function(e,t,n){function r(e,t){if(!e)throw new i("The storageContext is required");this.storageContext=e,this.options=o({},{limit:400},t)}const o=n(7).assign,i=n(0).ArgumentError;r.prototype.read=function(){return this.storageContext.read().then(function(e){const t=e||{};return t.logs=t.logs||[],t})},r.prototype.write=function(e){return this.storageContext.write(e)},r.prototype.getCheckpoint=function(e){const t=this;return t.read().then(function(n){return e&&e!==n.startFrom?(n.startFrom=e,n.checkpointId=e,t.write(n).then(function(){return n.checkpointId||e||null})):n.checkpointId})},r.prototype.getToken=function(){return this.read().then(function(e){return e.logs_access_token||null})},r.prototype.setToken=function(e){const t=this;return t.read().then(function(n){return n.logs_access_token=e,t.write(n)})},r.prototype.done=function(e,t){const n=this;return n.read().then(function(r){return Buffer.byteLength(JSON.stringify(r),"utf8")>=1024*n.options.limit&&r.logs&&r.logs.length&&r.logs.splice(0,5),e.checkpoint=t,r.logs.push(e),r.checkpointId=t,n.write(r)})},e.exports=r},function(e,t,n){"use strict";var r=(n(62),n(71)),o=n(56),i=n(37),s=n(1),c=n(4);e.exports=function(e){return function(t,n,a){var u=t.webtaskContext&&t.webtaskContext.body||t.body||{},l=t.webtaskContext&&t.webtaskContext.headers||{};if(!(u.schedule&&"active"===u.state||l.referer===s("AUTH0_MANAGE_URL")+"/"&&l["if-none-match"]))return a();var f=o.createClient({token:s("LOGDNA_API_KEY"),tags:["auth0"]}),p=function(e,t){if(!e||!e.length)return t();c.info("Sending "+e.length+" logs to Logdna."),f.log(e,function(e){return e?(c.info("Error sending logs to Logdna",e),t(e)):(c.info("Upload complete."),t())})},d=new i.reporters.SlackReporter({hook:s("SLACK_INCOMING_WEBHOOK_URL"),username:"cota-auth0-to-logdna",title:"Logs To Logdna"}),h={domain:s("AUTH0_DOMAIN"),clientId:s("AUTH0_CLIENT_ID"),clientSecret:s("AUTH0_CLIENT_SECRET"),batchSize:s("BATCH_SIZE"),startFrom:s("START_FROM"),logLevel:s("LOG_LEVEL"),logTypes:s("LOG_TYPES")};(!h.batchSize||h.batchSize>100)&&(h.batchSize=100),h.logTypes&&!Array.isArray(h.logTypes)&&(h.logTypes=h.logTypes.replace(/\s/g,"").split(","));var g=new i.LogsProcessor(e,h),v=function(t){var n=new Date,r=n.getTime(),o=r-864e5;g.getReport(o,r).then(function(e){return d.send(e,e.checkpoint)}).then(function(){return e.read()}).then(function(n){return n.lastReportDate=t,e.write(n)})},m=function(){e.read().then(function(e){var t=r().format("DD-MM-YYYY"),n=s("DAILY_REPORT_TIME")||16;e.lastReportDate!==t&&(new Date).getHours()>=n&&v(t)})};return g.run(p).then(function(e){e&&e.status&&e.status.error?d.send(e.status,e.checkpoint):!0!==s("SLACK_SEND_SUCCESS")&&"true"!==s("SLACK_SEND_SUCCESS")||d.send(e.status,e.checkpoint),m(),n.json(e)}).catch(function(e){d.send({error:e,logsProcessed:0},null),m(),a(e)})}}},function(e,t,n){"use strict";var r=n(3).Router,o=n(2).middlewares,i=n(1),s=n(4);e.exports=function(){var e=r(),t=o.validateHookToken(i("AUTH0_DOMAIN"),i("WT_URL"),i("EXTENSION_SECRET"));return e.use("/on-uninstall",t("/.extensions/on-uninstall")),e.use(o.managementApiClient({domain:i("AUTH0_DOMAIN"),clientId:i("AUTH0_CLIENT_ID"),clientSecret:i("AUTH0_CLIENT_SECRET")})),e.delete("/on-uninstall",function(e,t){var n=i("AUTH0_CLIENT_ID");e.auth0.clients.delete({client_id:n}).then(function(){s.debug("Deleted client "+n),t.sendStatus(204)}).catch(function(e){s.debug("Error deleting client: "+i("AUTH0_CLIENT_ID")),s.error(e),t.sendStatus(204)})}),e}},function(e,t,n){"use strict";(function(t){var r=(n(69),n(67)),o=(n(18),n(2).urlHelpers),i=n(1);e.exports=function(){var e='\n  <!DOCTYPE html>\n  <html lang="en">\n  <head>\n    <title><%= config.TITLE %></title>\n    <meta charset="UTF-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/4.6.13/lib/logos/img/favicon.png">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css" />\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1672/css/index.min.css" />\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.6.13/index.min.css" />\n    <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="/app/<%= assets.style %>" /><% } %>\n    <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="//cdn.auth0.com/extensions/cota-auth0-to-logdna/assets/cota-auth0-to-logdna.ui.<%= assets.version %>.css" /><% } %>\n    <% if (assets.customCss) { %><link rel="stylesheet" type="text/css" href="<%= assets.customCss %>" /><% } %>\n  </head>\n  <body>\n    <div id="app"></div>\n    <script type="text/javascript" src="//cdn.auth0.com/w2/auth0-7.0.4.min.js"><\/script>\n    <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1672/js/bundle.js"><\/script>\n    <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n    <% if (assets.vendors) { %><script type="text/javascript" src="/app/<%= assets.vendors %>"><\/script><% } %>\n    <% if (assets.app) { %><script type="text/javascript" src="/app/<%= assets.app %>"><\/script><% } %>\n    <% if (assets.version) { %>\n    <script type="text/javascript" src="//cdn.auth0.com/extensions/cota-auth0-to-logdna/assets/cota-auth0-to-logdna.ui.vendors.<%= assets.version %>.js"><\/script>\n    <script type="text/javascript" src="//cdn.auth0.com/extensions/cota-auth0-to-logdna/assets/cota-auth0-to-logdna.ui.<%= assets.version %>.js"><\/script>\n    <% } %>\n  </body>\n  </html>\n  ';return function(t,n,s){if(0===t.url.indexOf("/api"))return s();var c={AUTH0_DOMAIN:i("AUTH0_DOMAIN"),AUTH0_CLIENT_ID:i("EXTENSION_CLIENT_ID"),AUTH0_MANAGE_URL:i("AUTH0_MANAGE_URL")||"https://manage.auth0.com",BASE_URL:o.getBaseUrl(t),BASE_PATH:o.getBasePath(t),TITLE:i("TITLE")};return n.send(r.render(e,{config:c,assets:{customCss:i("CUSTOM_CSS"),version:"2.0.2"}}))}}}).call(t,"/")},function(e,t,n){"use strict";var r=n(7),o=n(3).Router,i=n(2).middlewares,s=n(1),c=n(43);e.exports=function(e){var t=o(),n=i.authenticateAdmins({credentialsRequired:!0,secret:s("EXTENSION_SECRET"),audience:"urn:logs-to-logdna",baseUrl:s("PUBLIC_WT_URL")||s("WT_URL"),onLoginSuccess:function(e,t,n){return n()}}),a=i.managementApiClient({domain:s("AUTH0_DOMAIN"),clientId:s("AUTH0_CLIENT_ID"),clientSecret:s("AUTH0_CLIENT_SECRET")});return t.get("/",a,c()),t.get("/api/report",n,function(t,n,o){return e.read().then(function(e){var o=e&&e.logs?r.sortByOrder(e.logs,"start","desc"):[],i=t.query.filter&&"errors"===t.query.filter?r.filter(o,function(e){return!!e.error}):o,s=t.query.page&&parseInt(t.query.page)?parseInt(t.query.page)-1:0,c=t.query.per_page&&parseInt(t.query.per_page)||10,a=c*s;return n.json({logs:i.slice(a,a+c),total:i.length})}).catch(o)}),t}},function(e,t,n){"use strict";var r=n(3),o=n(49);e.exports=function(){var e=r.Router();return e.get("/",function(e,t){t.status(200).send(o)}),e}},function(e,t,n){"use strict";var r=n(2),o=n(21),i=n(1),s=n(4),c=r.createServer(function(e,t){return s.info("Starting Auth0 Logs to Logdna Extension - Version:","2.0.2"),o(e,t)});e.exports=function(e,t,n){i.setValue("PUBLIC_WT_URL",r.urlHelpers.getWebtaskUrl(t)),c(e,t,n)}},function(e,t,n){"use strict";function r(e,t){return function(n,r,o){if(n.cookies)return o();var s=n.headers.cookie,u=!e||Array.isArray(e)?e||[]:[e];if(n.secret=u[0],n.cookies=Object.create(null),n.signedCookies=Object.create(null),!s)return o();n.cookies=a.parse(s,t),0!==u.length&&(n.signedCookies=c(n.cookies,u),n.signedCookies=i(n.signedCookies)),n.cookies=i(n.cookies),o()}}function o(e){if("string"==typeof e&&"j:"===e.substr(0,2))try{return JSON.parse(e.slice(2))}catch(e){return}}function i(e){for(var t,n,r=Object.keys(e),i=0;i<r.length;i++)t=r[i],(n=o(e[t]))&&(e[t]=n);return e}function s(e,t){if("string"==typeof e){if("s:"!==e.substr(0,2))return e;for(var n=!t||Array.isArray(t)?t||[]:[t],r=0;r<n.length;r++){var o=u.unsign(e.slice(2),n[r]);if(!1!==o)return o}return!1}}function c(e,t){for(var n,r,o,i=Object.keys(e),c=Object.create(null),a=0;a<i.length;a++)r=i[a],o=e[r],n=s(o,t),o!==n&&(c[r]=n,delete e[r]);return c}var a=n(48),u=n(65);e.exports=r,e.exports.JSONCookie=o,e.exports.JSONCookies=i,e.exports.signedCookie=s,e.exports.signedCookies=c},function(e,t,n){"use strict";function r(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var n={},r=t||{},o=e.split(a),c=r.decode||s,u=0;u<o.length;u++){var l=o[u],f=l.indexOf("=");if(!(f<0)){var p=l.substr(0,f).trim(),d=l.substr(++f,l.length).trim();'"'==d[0]&&(d=d.slice(1,-1)),void 0==n[p]&&(n[p]=i(d,c))}}return n}function o(e,t,n){var r=n||{},o=r.encode||c;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!u.test(e))throw new TypeError("argument name is invalid");var i=o(t);if(i&&!u.test(i))throw new TypeError("argument val is invalid");var s=e+"="+i;if(null!=r.maxAge){var a=r.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");s+="; Max-Age="+Math.floor(a)}if(r.domain){if(!u.test(r.domain))throw new TypeError("option domain is invalid");s+="; Domain="+r.domain}if(r.path){if(!u.test(r.path))throw new TypeError("option path is invalid");s+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");s+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite){switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return s}function i(e,t){try{return t(e)}catch(t){return e}}t.parse=r,t.serialize=o;var s=decodeURIComponent,c=encodeURIComponent,a=/; */,u=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(e,t){e.exports={title:"Cota Auth0 to Logdna",name:"cota-auth0-to-logdna",version:"2.0.2",author:"auth0",description:"This extension will take all of your Auth0 logs and export them to Logdna",initialUrlPath:"/login",type:"cron",category:"log_export",keywords:["auth0","extension"],schedule:"0 */5 * * * *",auth0:{createClient:!0,onUninstallPath:"/.extensions/on-uninstall",scopes:"read:logs delete:clients"},secrets:{BATCH_SIZE:{description:"The amount of logs to batch before sending to Logstash. A single cron execution will send multiple batches.",default:100},LOGDNA_API_KEY:{description:"Logdna api key",required:!0,type:"password"},START_FROM:{description:"Checkpoint ID of log to start from."},SLACK_INCOMING_WEBHOOK_URL:{description:"Slack Incoming Webhook URL used to report statistics and possible failures"},SLACK_SEND_SUCCESS:{description:"This setting will enable verbose notifications to Slack which are useful for troubleshooting",type:"select",allowMultiple:!1,default:"false",options:[{value:"false",text:"No"},{value:"true",text:"Yes"}]},LOG_LEVEL:{description:"This allows you to specify the log level of events that need to be sent",type:"select",allowMultiple:!0,options:[{value:"-",text:""},{value:"0",text:"Debug"},{value:"1",text:"Info"},{value:"2",text:"Warning"},{value:"3",text:"Error"},{value:"4",text:"Critical"}]},LOG_TYPES:{description:"If you only want to send events with a specific type (eg: failed logins)",type:"select",allowMultiple:!0,options:[{text:"",value:"-"},{text:"Success Login",value:"s"},{text:"Success Exchange",value:"seacft"},{text:"Success Exchange (Client Credentials)",value:"seccft"},{text:"Failed Exchange",value:"feacft"},{text:"Failed Exchange (Client Credentials)",value:"feccft"},{text:"Failed Login",value:"f"},{text:"Warnings During Login",value:"w"},{text:"Deleted User",value:"du"},{text:"Failed Login (invalid email/username)",value:"fu"},{text:"Failed Login (wrong password)",value:"fp"},{text:"Failed by Connector",value:"fc"},{text:"Failed by CORS",value:"fco"},{text:"Connector Online",value:"con"},{text:"Connector Offline",value:"coff"},{text:"Failed Connector Provisioning",value:"fcpro"},{text:"Success Signup",value:"ss"},{text:"Failed Signup",value:"fs"},{text:"Code Sent",value:"cs"},{text:"Code/Link Sent",value:"cls"},{text:"Success Verification Email",value:"sv"},{text:"Failed Verification Email",value:"fv"},{text:"Success Change Password",value:"scp"},{text:"Failed Change Password",value:"fcp"},{text:"Success Change Email",value:"sce"},{text:"Failed Change Email",value:"fce"},{text:"Success Change Username",value:"scu"},{text:"Failed Change Username",value:"fcu"},{text:"Success Change Phone Number",value:"scpn"},{text:"Failed Change Phone Number",value:"fcpn"},{text:"Success Verification Email Request",value:"svr"},{text:"Failed Verification Email Request",value:"fvr"},{text:"Success Change Password Request",value:"scpr"},{text:"Failed Change Password Request",value:"fcpr"},{text:"Failed Sending Notification",value:"fn"},{text:"API Operation",value:"sapi"},{text:"Failed API Operation",value:"fapi"},{text:"Blocked Account",value:"limit_wc"},{text:"Too Many Calls to /userinfo",value:"limit_ui"},{text:"Rate Limit On API",value:"api_limit"},{text:"Successful User Deletion",value:"sdu"},{text:"Failed User Deletion",value:"fdu"},{text:"Blocked Account",value:"limit_wc"},{text:"Blocked IP Address",value:"limit_mu"},{text:"Success Logout",value:"slo"},{text:"Failed Logout",value:"flo"},{text:"Success Delegation",value:"sd"},{text:"Failed Delegation",value:"fd"}]}}}},function(e,t){function n(e,t,n,o){return JSON.stringify(e,r(t,o),n)}function r(e,t){var n=[],r=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(o,i){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?r.splice(s,1/0,o):r.push(o),~n.indexOf(i)&&(i=t.call(this,o,i))}else n.push(i);return null==e?i:e.call(this,o,i)}}t=e.exports=n,t.getSerialize=r},function(e,t){function n(e){this.message=e}function r(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,s=0,c=0,a="";i=t.charAt(c++);~i&&(r=s%4?64*r+i:i,s++%4)?a+=String.fromCharCode(255&r>>(-2*s&6)):0)i=o.indexOf(i);return a}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||r},function(e,t,n){function r(e){return decodeURIComponent(o(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}var o=n(51);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return r(t)}catch(e){return o(t)}}},function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););return e}function o(e,t){return!!(e?e.length:0)&&s(e,t,0)>-1}function i(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}function s(e,t,n){if(t!==t)return i(e,c,n);for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function c(e){return e!==e}function a(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&r++;return r}function u(e,t){return null==e?void 0:e[t]}function l(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function f(e,t){for(var n=-1,r=e.length,o=0,i=[];++n<r;){var s=e[n];s!==t&&s!==z||(e[n]=z,i[o++]=n)}return i}function p(e){return N(e)?Le(e):{}}function d(e){return!(!N(e)||L(e))&&(I(e)||l(e)?Ce:he).test(U(e))}function h(e,t,n,r){for(var o=-1,i=e.length,s=n.length,c=-1,a=t.length,u=Oe(i-s,0),l=Array(a+u),f=!r;++c<a;)l[c]=t[c];for(;++o<s;)(f||o<i)&&(l[n[o]]=e[o]);for(;u--;)l[c++]=e[o++];return l}function g(e,t,n,r){for(var o=-1,i=e.length,s=-1,c=n.length,a=-1,u=t.length,l=Oe(i-c,0),f=Array(l+u),p=!r;++o<l;)f[o]=e[o];for(var d=o;++a<u;)f[d+a]=t[a];for(;++s<c;)(p||o<i)&&(f[d+n[s]]=e[o++]);return f}function v(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function m(e,t,n){function r(){return(this&&this!==be&&this instanceof r?i:e).apply(o?n:this,arguments)}var o=t&G,i=y(e);return r}function y(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=p(e.prototype),r=e.apply(n,t);return N(r)?r:n}}function _(e,t,r){function o(){for(var s=arguments.length,c=Array(s),a=s,u=E(o);a--;)c[a]=arguments[a];var l=s<3&&c[0]!==u&&c[s-1]!==u?[]:f(c,u);return(s-=l.length)<r?x(e,t,b,o.placeholder,void 0,c,l,void 0,void 0,r-s):n(this&&this!==be&&this instanceof o?i:e,this,c)}var i=y(e);return o}function b(e,t,n,r,o,i,s,c,u,l){function p(){for(var A=arguments.length,S=Array(A),T=A;T--;)S[T]=arguments[T];if(_)var C=E(p),L=a(S,C);if(r&&(S=h(S,r,o,_)),i&&(S=g(S,i,s,_)),A-=L,_&&A<l){var U=f(S,C);return x(e,t,b,p.placeholder,n,S,U,c,u,l-A)}var j=v?n:this,I=m?j[e]:e;return A=S.length,c?S=O(S,c):w&&A>1&&S.reverse(),d&&u<A&&(S.length=u),this&&this!==be&&this instanceof p&&(I=k||y(I)),I.apply(j,S)}var d=t&J,v=t&G,m=t&$,_=t&(W|K),w=t&Q,k=m?void 0:y(e);return p}function w(e,t,r,o){function i(){for(var t=-1,a=arguments.length,u=-1,l=o.length,f=Array(l+a),p=this&&this!==be&&this instanceof i?c:e;++u<l;)f[u]=o[u];for(;a--;)f[u++]=arguments[++t];return n(p,s?r:this,f)}var s=t&G,c=y(e);return i}function x(e,t,n,r,o,i,s,c,a,u){var l=t&W,f=l?s:void 0,p=l?void 0:s,d=l?i:void 0,h=l?void 0:i;t|=l?X:Y,(t&=~(l?Y:X))&V||(t&=~(G|$));var g=n(e,t,o,d,f,h,p,c,a,u);return g.placeholder=r,Ie(g,e,t)}function k(e,t,n,r,o,i,s,c){var a=t&$;if(!a&&"function"!=typeof e)throw new TypeError(B);var u=r?r.length:0;if(u||(t&=~(X|Y),r=o=void 0),s=void 0===s?s:Oe(D(s),0),c=void 0===c?c:D(c),u-=o?o.length:0,t&Y){var l=r,f=o;r=o=void 0}var p=[e,t,n,r,o,l,f,i,s,c];if(e=p[0],t=p[1],n=p[2],r=p[3],o=p[4],c=p[9]=null==p[9]?a?0:e.length:Oe(p[9]-u,0),!c&&t&(W|K)&&(t&=~(W|K)),t&&t!=G)d=t==W||t==K?_(e,t,c):t!=X&&t!=(G|X)||o.length?b.apply(void 0,p):w(e,t,n,r);else var d=m(e,t,n);return Ie(d,e,t)}function E(e){return e.placeholder}function A(e,t){var n=u(e,t);return d(n)?n:void 0}function S(e){var t=e.match(le);return t?t[1].split(fe):[]}function T(e,t){var n=t.length,r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ue,"{\n/* [wrapped with "+t+"] */\n")}function C(e,t){return!!(t=null==t?ee:t)&&("number"==typeof e||ve.test(e))&&e>-1&&e%1==0&&e<t}function L(e){return!!Ee&&Ee in e}function O(e,t){for(var n=e.length,r=Ue(t.length,n),o=v(e);r--;){var i=t[r];e[r]=C(i,n)?o[i]:void 0}return e}function U(e){if(null!=e){try{return Ae.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function j(e,t){return r(re,function(n){var r="_."+n[0];t&n[1]&&!o(e,r)&&e.push(r)}),e.sort()}function I(e){var t=N(e)?Te.call(e):"";return t==oe||t==ie}function N(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function R(e){return!!e&&"object"==typeof e}function M(e){return"symbol"==typeof e||R(e)&&Te.call(e)==se}function P(e){if(!e)return 0===e?e:0;if((e=F(e))===Z||e===-Z){return(e<0?-1:1)*te}return e===e?e:0}function D(e){var t=P(e),n=t%1;return t===t?n?t-n:t:0}function F(e){if("number"==typeof e)return e;if(M(e))return ne;if(N(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=N(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ae,"");var n=de.test(e);return n||ge.test(e)?me(e.slice(2),n?2:8):pe.test(e)?ne:+e}function q(e){return function(){return e}}function H(e){return e}var B="Expected a function",z="__lodash_placeholder__",G=1,$=2,V=4,W=8,K=16,X=32,Y=64,J=128,Q=512,Z=1/0,ee=9007199254740991,te=1.7976931348623157e308,ne=NaN,re=[["ary",J],["bind",G],["bindKey",$],["curry",W],["curryRight",K],["flip",Q],["partial",X],["partialRight",Y],["rearg",256]],oe="[object Function]",ie="[object GeneratorFunction]",se="[object Symbol]",ce=/[\\^$.*+?()[\]{}|]/g,ae=/^\s+|\s+$/g,ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,fe=/,? & /,pe=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,he=/^\[object .+?Constructor\]$/,ge=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,me=parseInt,ye="object"==typeof global&&global&&global.Object===Object&&global,_e="object"==typeof self&&self&&self.Object===Object&&self,be=ye||_e||Function("return this")(),we=Function.prototype,xe=Object.prototype,ke=be["__core-js_shared__"],Ee=function(){var e=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ae=we.toString,Se=xe.hasOwnProperty,Te=xe.toString,Ce=RegExp("^"+Ae.call(Se).replace(ce,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Le=Object.create,Oe=Math.max,Ue=Math.min,je=function(){var e=A(Object,"defineProperty"),t=A.name;return t&&t.length>2?e:void 0}(),Ie=je?function(e,t,n){var r=t+"";return je(e,"toString",{configurable:!0,enumerable:!1,value:q(T(r,j(S(r),n)))})}:H,Ne=function(e,t){return t=Oe(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=Oe(r.length-t,0),s=Array(i);++o<i;)s[o]=r[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=r[o];return c[t]=s,n(e,this,c)}}(function(e,t,n){var r=G;if(n.length){var o=f(n,E(Ne));r|=X}return k(e,r,t,n,o)});Ne.placeholder={},e.exports=Ne},function(e,t){function n(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););return e}function r(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function o(e,t){var n=U(e)||l(e)?r(e.length,String):[],o=n.length,i=!!o;for(var s in e)!t&&!A.call(e,s)||i&&("length"==s||c(s,o))||n.push(s);return n}function i(e,t){return e&&O(e,t,m)}function s(e){if(!a(e))return C(e);var t=[];for(var n in Object(e))A.call(e,n)&&"constructor"!=n&&t.push(n);return t}function c(e,t){return!!(t=null==t?_:t)&&("number"==typeof e||k.test(e))&&e>-1&&e%1==0&&e<t}function a(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||E)}function u(e,t){return(U(e)?n:L)(e,"function"==typeof t?t:y)}function l(e){return p(e)&&A.call(e,"callee")&&(!T.call(e,"callee")||S.call(e)==b)}function f(e){return null!=e&&h(e.length)&&!d(e)}function p(e){return v(e)&&f(e)}function d(e){var t=g(e)?S.call(e):"";return t==w||t==x}function h(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=_}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){return!!e&&"object"==typeof e}function m(e){return f(e)?o(e):s(e)}function y(e){return e}var _=9007199254740991,b="[object Arguments]",w="[object Function]",x="[object GeneratorFunction]",k=/^(?:0|[1-9]\d*)$/,E=Object.prototype,A=E.hasOwnProperty,S=E.toString,T=E.propertyIsEnumerable,C=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),L=function(e,t){return function(n,r){if(null==n)return n;if(!f(n))return e(n,r);for(var o=n.length,i=t?o:-1,s=Object(n);(t?i--:++i<o)&&!1!==r(s[i],i,s););return n}}(i),O=function(e){return function(t,n,r){for(var o=-1,i=Object(t),s=r(t),c=s.length;c--;){var a=s[e?c:++o];if(!1===n(i[a],a,i))break}return t}}(),U=Array.isArray;e.exports=u},function(e,t,n){(function(e){function n(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[o++]=s)}return i}function r(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function o(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function i(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function s(e,t){return e.has(t)}function c(e,t){return null==e?void 0:e[t]}function a(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function u(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function f(){this.__data__=kt?kt(null):{},this.size=0}function p(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function d(e){var t=this.__data__;if(kt){var n=t[e];return n===me?void 0:n}return it.call(t,e)?t[e]:void 0}function h(e){var t=this.__data__;return kt?void 0!==t[e]:it.call(t,e)}function g(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=kt&&void 0===t?me:t,this}function v(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function m(){this.__data__=[],this.size=0}function y(e){var t=this.__data__,n=D(t,e);return!(n<0)&&(n==t.length-1?t.pop():dt.call(t,n,1),--this.size,!0)}function _(e){var t=this.__data__,n=D(t,e);return n<0?void 0:t[n][1]}function b(e){return D(this.__data__,e)>-1}function w(e,t){var n=this.__data__,r=D(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function x(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function k(){this.size=0,this.__data__={hash:new l,map:new(_t||v),string:new l}}function E(e){var t=J(this,e).delete(e);return this.size-=t?1:0,t}function A(e){return J(this,e).get(e)}function S(e){return J(this,e).has(e)}function T(e,t){var n=J(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function C(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new x;++t<n;)this.add(e[t])}function L(e){return this.__data__.set(e,me),this}function O(e){return this.__data__.has(e)}function U(e){var t=this.__data__=new v(e);this.size=t.size}function j(){this.__data__=new v,this.size=0}function I(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function N(e){return this.__data__.get(e)}function R(e){return this.__data__.has(e)}function M(e,t){var n=this.__data__;if(n instanceof v){var r=n.__data__;if(!_t||r.length<ve-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new x(r)}return n.set(e,t),this.size=n.size,this}function P(e,t){var n=Nt(e),r=!n&&It(e),o=!n&&!r&&Rt(e),s=!n&&!r&&!o&&Mt(e),c=n||r||o||s,a=c?i(e.length,String):[],u=a.length;for(var l in e)!t&&!it.call(e,l)||c&&("length"==l||o&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ee(l,u))||a.push(l);return a}function D(e,t){for(var n=e.length;n--;)if(se(e[n][0],t))return n;return-1}function F(e,t,n){var o=t(e);return Nt(e)?o:r(o,n(e))}function q(e){return null==e?void 0===e?De:Ue:ht&&ht in Object(e)?Z(e):oe(e)}function H(e){return pe(e)&&q(e)==we}function B(e,t,n,r,o){return e===t||(null==e||null==t||!pe(e)&&!pe(t)?e!==e&&t!==t:z(e,t,n,r,B,o))}function z(e,t,n,r,o,i){var s=Nt(e),c=Nt(t),a=s?xe:jt(e),u=c?xe:jt(t);a=a==we?je:a,u=u==we?je:u;var l=a==je,f=u==je,p=a==u;if(p&&Rt(e)){if(!Rt(t))return!1;s=!0,l=!1}if(p&&!l)return i||(i=new U),s||Mt(e)?W(e,t,n,r,o,i):K(e,t,a,n,r,o,i);if(!(n&ye)){var d=l&&it.call(e,"__wrapped__"),h=f&&it.call(t,"__wrapped__");if(d||h){var g=d?e.value():e,v=h?t.value():t;return i||(i=new U),o(g,v,n,r,i)}}return!!p&&(i||(i=new U),X(e,t,n,r,o,i))}function G(e){return!(!fe(e)||ne(e))&&(ue(e)?at:Be).test(ie(e))}function $(e){return pe(e)&&le(e.length)&&!!Ge[q(e)]}function V(e){if(!re(e))return mt(e);var t=[];for(var n in Object(e))it.call(e,n)&&"constructor"!=n&&t.push(n);return t}function W(e,t,n,r,i,c){var a=n&ye,u=e.length,l=t.length;if(u!=l&&!(a&&l>u))return!1;var f=c.get(e);if(f&&c.get(t))return f==t;var p=-1,d=!0,h=n&_e?new C:void 0;for(c.set(e,t),c.set(t,e);++p<u;){var g=e[p],v=t[p];if(r)var m=a?r(v,g,p,t,e,c):r(g,v,p,e,t,c);if(void 0!==m){if(m)continue;d=!1;break}if(h){if(!o(t,function(e,t){if(!s(h,t)&&(g===e||i(g,e,n,r,c)))return h.push(t)})){d=!1;break}}else if(g!==v&&!i(g,v,n,r,c)){d=!1;break}}return c.delete(e),c.delete(t),d}function K(e,t,n,r,o,i,s){switch(n){case qe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Fe:return!(e.byteLength!=t.byteLength||!i(new ft(e),new ft(t)));case Ee:case Ae:case Oe:return se(+e,+t);case Se:return e.name==t.name&&e.message==t.message;case Ne:case Me:return e==t+"";case Le:var c=a;case Re:var l=r&ye;if(c||(c=u),e.size!=t.size&&!l)return!1;var f=s.get(e);if(f)return f==t;r|=_e,s.set(e,t);var p=W(c(e),c(t),r,o,i,s);return s.delete(e),p;case Pe:if(Ot)return Ot.call(e)==Ot.call(t)}return!1}function X(e,t,n,r,o,i){var s=n&ye,c=Y(e),a=c.length;if(a!=Y(t).length&&!s)return!1;for(var u=a;u--;){var l=c[u];if(!(s?l in t:it.call(t,l)))return!1}var f=i.get(e);if(f&&i.get(t))return f==t;var p=!0;i.set(e,t),i.set(t,e);for(var d=s;++u<a;){l=c[u];var h=e[l],g=t[l];if(r)var v=s?r(g,h,l,t,e,i):r(h,g,l,e,t,i);if(!(void 0===v?h===g||o(h,g,n,r,i):v)){p=!1;break}d||(d="constructor"==l)}if(p&&!d){var m=e.constructor,y=t.constructor;m!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y)&&(p=!1)}return i.delete(e),i.delete(t),p}function Y(e){return F(e,de,Ut)}function J(e,t){var n=e.__data__;return te(t)?n["string"==typeof t?"string":"hash"]:n.map}function Q(e,t){var n=c(e,t);return G(n)?n:void 0}function Z(e){var t=it.call(e,ht),n=e[ht];try{e[ht]=void 0;var r=!0}catch(e){}var o=ct.call(e);return r&&(t?e[ht]=n:delete e[ht]),o}function ee(e,t){return!!(t=null==t?be:t)&&("number"==typeof e||ze.test(e))&&e>-1&&e%1==0&&e<t}function te(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function ne(e){return!!st&&st in e}function re(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||nt)}function oe(e){return ct.call(e)}function ie(e){if(null!=e){try{return ot.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function se(e,t){return e===t||e!==e&&t!==t}function ce(e){return null!=e&&le(e.length)&&!ue(e)}function ae(e,t){return B(e,t)}function ue(e){if(!fe(e))return!1;var t=q(e);return t==Te||t==Ce||t==ke||t==Ie}function le(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=be}function fe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function pe(e){return null!=e&&"object"==typeof e}function de(e){return ce(e)?P(e):V(e)}function he(){return[]}function ge(){return!1}var ve=200,me="__lodash_hash_undefined__",ye=1,_e=2,be=9007199254740991,we="[object Arguments]",xe="[object Array]",ke="[object AsyncFunction]",Ee="[object Boolean]",Ae="[object Date]",Se="[object Error]",Te="[object Function]",Ce="[object GeneratorFunction]",Le="[object Map]",Oe="[object Number]",Ue="[object Null]",je="[object Object]",Ie="[object Proxy]",Ne="[object RegExp]",Re="[object Set]",Me="[object String]",Pe="[object Symbol]",De="[object Undefined]",Fe="[object ArrayBuffer]",qe="[object DataView]",He=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,ze=/^(?:0|[1-9]\d*)$/,Ge={};Ge["[object Float32Array]"]=Ge["[object Float64Array]"]=Ge["[object Int8Array]"]=Ge["[object Int16Array]"]=Ge["[object Int32Array]"]=Ge["[object Uint8Array]"]=Ge["[object Uint8ClampedArray]"]=Ge["[object Uint16Array]"]=Ge["[object Uint32Array]"]=!0,Ge[we]=Ge[xe]=Ge[Fe]=Ge[Ee]=Ge[qe]=Ge[Ae]=Ge[Se]=Ge[Te]=Ge[Le]=Ge[Oe]=Ge[je]=Ge[Ne]=Ge[Re]=Ge[Me]=Ge["[object WeakMap]"]=!1;var $e="object"==typeof global&&global&&global.Object===Object&&global,Ve="object"==typeof self&&self&&self.Object===Object&&self,We=$e||Ve||Function("return this")(),Ke="object"==typeof t&&t&&!t.nodeType&&t,Xe=Ke&&"object"==typeof e&&e&&!e.nodeType&&e,Ye=Xe&&Xe.exports===Ke,Je=Ye&&$e.process,Qe=function(){try{return Je&&Je.binding&&Je.binding("util")}catch(e){}}(),Ze=Qe&&Qe.isTypedArray,et=Array.prototype,tt=Function.prototype,nt=Object.prototype,rt=We["__core-js_shared__"],ot=tt.toString,it=nt.hasOwnProperty,st=function(){var e=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ct=nt.toString,at=RegExp("^"+ot.call(it).replace(He,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ut=Ye?We.Buffer:void 0,lt=We.Symbol,ft=We.Uint8Array,pt=nt.propertyIsEnumerable,dt=et.splice,ht=lt?lt.toStringTag:void 0,gt=Object.getOwnPropertySymbols,vt=ut?ut.isBuffer:void 0,mt=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),yt=Q(We,"DataView"),_t=Q(We,"Map"),bt=Q(We,"Promise"),wt=Q(We,"Set"),xt=Q(We,"WeakMap"),kt=Q(Object,"create"),Et=ie(yt),At=ie(_t),St=ie(bt),Tt=ie(wt),Ct=ie(xt),Lt=lt?lt.prototype:void 0,Ot=Lt?Lt.valueOf:void 0;l.prototype.clear=f,l.prototype.delete=p,l.prototype.get=d,l.prototype.has=h,l.prototype.set=g,v.prototype.clear=m,v.prototype.delete=y,v.prototype.get=_,v.prototype.has=b,v.prototype.set=w,x.prototype.clear=k,x.prototype.delete=E,x.prototype.get=A,x.prototype.has=S,x.prototype.set=T,C.prototype.add=C.prototype.push=L,C.prototype.has=O,U.prototype.clear=j,U.prototype.delete=I,U.prototype.get=N,U.prototype.has=R,U.prototype.set=M;var Ut=gt?function(e){return null==e?[]:(e=Object(e),n(gt(e),function(t){return pt.call(e,t)}))}:he,jt=q;(yt&&jt(new yt(new ArrayBuffer(1)))!=qe||_t&&jt(new _t)!=Le||bt&&"[object Promise]"!=jt(bt.resolve())||wt&&jt(new wt)!=Re||xt&&"[object WeakMap]"!=jt(new xt))&&(jt=function(e){var t=q(e),n=t==je?e.constructor:void 0,r=n?ie(n):"";if(r)switch(r){case Et:return qe;case At:return Le;case St:return"[object Promise]";case Tt:return Re;case Ct:return"[object WeakMap]"}return t});var It=H(function(){return arguments}())?H:function(e){return pe(e)&&it.call(e,"callee")&&!pt.call(e,"callee")},Nt=Array.isArray,Rt=vt||ge,Mt=Ze?function(e){return function(t){return e(t)}}(Ze):$;e.exports=ae}).call(t,n(36)(e))},function(e,t,n){var r,o=n(58),i=function(e,t){return r instanceof o.Logger||(r=o.createLogger(e,t)),r};e.exports={cleanUpAll:o.cleanUpAll,createLogger:o.createLogger,flushAll:o.flushAll,Logger:o.Logger,setupDefaultLogger:i}},function(e,t,n){var r=n(22);e.exports={LOG_LEVELS:["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"],DEFAULT_REQUEST_HEADER:{"Content-Type":"application/json; charset=UTF-8"},DEFAULT_REQUEST_TIMEOUT:18e4,MS_IN_A_DAY:864e5,MAX_REQUEST_TIMEOUT:3e5,MAX_LINE_LENGTH:32e3,MAX_INPUT_LENGTH:80,FLUSH_INTERVAL:250,FLUSH_BYTE_LIMIT:"test"===n.i({NODE_ENV:"production",CLIENT_VERSION:"2.0.2"}).test?32e4:5e6,AGENT_SETTING:{maxSockets:20,keepAliveTimeout:6e4},AGENT_PROTOCOL:"test"===n.i({NODE_ENV:"production",CLIENT_VERSION:"2.0.2"}).test?r:r.HttpsAgent,LOGDNA_URL:"test"===n.i({NODE_ENV:"production",CLIENT_VERSION:"2.0.2"}).test?"http://localhost:1337":"https://logs.logdna.com/logs/ingest",MAC_ADDR_CHECK:/^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$/,IP_ADDR_CHECK:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/}},function(e,t,n){function r(e){return!isNaN(e)&&function(e){return(0|e)===e}(parseFloat(e))}function o(e,t,n){if(!n||e){if(!e||"string"!=typeof e)throw new Error(t+" is undefined or not passed as a String");if(e.length>v.MAX_INPUT_LENGTH)throw new Error(t+" cannot be longer than "+v.MAX_INPUT_LENGTH+" chars")}}function i(e){return!(!(new Date(e).getTime()>0)||Math.abs(e-Date.now())>v.MS_IN_A_DAY)||(p("Error: The timestamp used is either invalid or not within one day. Date.now() will be used in its place."),!1)}function s(e,t){if(!(this instanceof s))return new s(e,t);if(o(e,"LogDNA Ingestion Key",!1),o(t.hostname,"Hostname",!0),o(t.mac,"MAC Address",!0),o(t.ip,"IP Address",!0),o(t.level,"Level",!0),o(t.app,"App",!0),t.timeout){if(!r(t.timeout))throw new Error("Timeout must be an Integer");if(t.timeout>v.MAX_REQUEST_TIMEOUT)throw new Error("Timeout cannot be longer than"+v.MAX_REQUEST_TIMEOUT)}if(t.mac&&!v.MAC_ADDR_CHECK.test(t.mac))throw new Error("Invalid MAC Address format");if(t.ip&&!v.IP_ADDR_CHECK.test(t.ip))throw new Error("Invalid IP Address format");this._max_length=t.max_length||!0,this._index_meta=t.index_meta||!1,this._flushLimit=v.FLUSH_BYTE_LIMIT,this._url=v.LOGDNA_URL;var n=v.AGENT_PROTOCOL;this._agent=new n(v.AGENT_SETTING),this._bufByteLength=0,this._buf=[],this._err,this.source={hostname:t.hostname||c.hostname(),app:t.app||"default",level:t.level||"INFO",env:t.env||void 0},this._req=a.defaults({auth:{username:e},agent:this._agent,headers:v.DEFAULT_REQUEST_HEADER,qs:{hostname:this.source.hostname,mac:t.mac,ip:t.ip},timeout:t.timeout||v.DEFAULT_REQUEST_TIMEOUT}),m.push(this)}var c=n(74),a=n(76),u=n(60),l=n(50),f=n(5),p=f.debuglog("logdna"),d=n(53),h=n(55),g=n(54),v=n(57),m=[];s.prototype.log=function(e,t){this._err=!1,"object"==typeof e&&(e=l(e,null,2,function(){}));var n={timestamp:Date.now(),line:e,level:this.source.level,app:this.source.app,env:this.source.env};if(t&&("string"==typeof t?(t.length>v.MAX_INPUT_LENGTH&&(p("Level had more than "+v.MAX_INPUT_LENGTH+" chars, was truncated"),t=t.substring(0,v.MAX_INPUT_LENGTH)),n.level=t):("object"!=typeof t&&(this._err=!0,p("Can only pass a String or JSON object as additional parameter")),n.level=t.level||n.level,n.app=t.app||n.app,n.env=t.env||n.env,t.timestamp&&i(t.timestamp)&&(n.timestamp=t.timestamp),t.context&&!t.meta&&(t.meta=t.context),"object"==typeof t.meta&&(this._index_meta||t.index_meta?n.meta=t.meta:n.meta=l(t.meta)))),this._err)return this._err;this._bufferLog(n)},s.prototype._bufferLog=function(e){if(e&&e.line){if(this._max_length&&e.line.length>v.MAX_LINE_LENGTH&&(e.line=e.line.substring(0,v.MAX_LINE_LENGTH)+" (cut off, too long...)",p("Line was longer than "+v.MAX_LINE_LENGTH+" chars and was truncated.")),this._bufByteLength+=u(e),this._buf.push(e),this._bufByteLength>=this._flushLimit)return void this._flush();this._flusher||(this._flusher=setTimeout(d(this._flush,this),v.FLUSH_INTERVAL))}},s.prototype._flush=function(e){if(!this._req||0===this._buf.length)return void(e&&e());var t={e:"ls",ls:this._buf},n=l(t);this._bufByteLength=0,this._buf.length=0,this._req.post(this._url,{body:n,qs:{now:Date.now()}},function(t){t&&p("Encountered an Error in POST Request: %j",t),e&&e(t)}),clearTimeout(this._flusher),this._flusher=null},s.prototype._cleanUp=function(e){this._flush(e);for(var t=0;t<m.length;t++)if(h(m[t],this))return void m.splice(t,1)},g(v.LOG_LEVELS,function(e){var t=e.toLowerCase();s.prototype[t]=function(t,n){n=n||{},n.level=e,this.log(t,n)}});var y=function(e){function t(){n--<1&&e()}var n=m.length;if(n)for(var r=0;r<m.length;r++)m[r]._flush(t);else e()};t.Logger=s,t.createLogger=function(e,t){var n=new s(e,t);return m.push(n),n},t.flushAll=y,t.cleanUpAll=function(e){y(e),m=[]}},function(e,t){e.exports={STRING:2,BOOLEAN:4,NUMBER:8}},function(e,t,n){"use strict";function r(e){if(null!==e&&"object"==typeof e){if(i.isBuffer(e))return e.length;var t=0;for(var n in e)if(Object.hasOwnProperty.call(e,n)){t+=r(n);try{t+=r(e[n])}catch(e){e instanceof RangeError&&(t=0)}}return t}return"string"==typeof e?e.length*o.STRING:"boolean"==typeof e?o.BOOLEAN:"number"==typeof e?o.NUMBER:0}var o=n(59),i=n(64).Buffer;e.exports=r},function(e,t,n){function r(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}var i=n(80);e.exports=i(r),e.exports.strict=i(o),r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(e,t){e.exports=require("async@2.1.2")},function(e,t){e.exports=require("body-parser@1.12.4")},function(e,t){e.exports=require("buffer")},function(e,t){e.exports=require("cookie-signature")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("ejs@2.3.1")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("jwks-rsa")},function(e,t){e.exports=require("moment@2.10.3")},function(e,t){e.exports=require("morgan@1.5.3")},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("request@2.56.0")},function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("webtask-tools")},function(e,t){e.exports=require("winston@1.0.0")},function(e,t){e.exports=require("wrappy")}]);